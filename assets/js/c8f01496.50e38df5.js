"use strict";(self.webpackChunkxceed_doc_ui=self.webpackChunkxceed_doc_ui||[]).push([[9882],{5505:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>d,toc:()=>u});var a=r(4848),n=r(8453),o=r(1470),i=r(9365);const s={},l="Clipboard Support",d={id:"fundamentals/clipboard-support",title:"Clipboard Support",description:"Xceed DataGrid for WPF supports clipboard copy support, which places the contents of the rows selected in the datagrid control and the details (the SelectedItems) into the clipboard using the formats contained in the ClipboardExporters property, in the visible order. Once the content has been placed in the clipboard, the Paste Special command in applications supporting this feature can be used to choose which format is used for the Paste operation.",source:"@site/datagrid/fundamentals/clipboard-support.md",sourceDirName:"fundamentals",slug:"/fundamentals/clipboard-support",permalink:"/xceed-doc-ui/datagrid/fundamentals/clipboard-support",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"sidebardatagrid",previous:{title:"DataGridPageControl Template",permalink:"/xceed-doc-ui/datagrid/fundamentals/templates/datagridpagecontrol-template"},next:{title:"Commands",permalink:"/xceed-doc-ui/datagrid/fundamentals/commands"}},c={},u=[{value:"Dragging",id:"dragging",level:2},{value:"Examples",id:"examples",level:2}];function p(e){const t={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",strong:"strong",...(0,n.R)(),...e.components},{Details:r}=t;return r||function(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"clipboard-support",children:"Clipboard Support"})}),"\n",(0,a.jsxs)(t.p,{children:["Xceed DataGrid for WPF supports clipboard copy support, which places the contents of the rows selected in the datagrid control and the details (the ",(0,a.jsx)(t.code,{children:"SelectedItems"}),") into the clipboard using the formats contained in the ClipboardExporters property, in the visible order. Once the content has been placed in the clipboard, the ",(0,a.jsx)(t.code,{children:"Paste Special"})," command in applications supporting this feature can be used to choose which format is used for the Paste operation."]}),"\n",(0,a.jsxs)(t.p,{children:["By default, ClipboardExporters contains four ",(0,a.jsx)(t.code,{children:"ClipboardExporterBase"})," objects. Two ",(0,a.jsx)(t.code,{children:"CsvClipboardExporter"}),' objects represent the comma-separated value format, "CSV," and the tab-separated value format, "Text," respectively. A ',(0,a.jsx)(t.code,{children:"UnicodeCsvClipboardExporter"})," object represents a comma-separated value format supporting Unicode . Finally, an ",(0,a.jsx)(t.code,{children:"HtmlClipboardExporter"})," object is used to export the data in a table, using the following tags: ",(0,a.jsx)(t.code,{children:"<Table><TR><TD></TD></TR></Table>"}),"."]}),"\n",(0,a.jsx)(t.admonition,{type:"tip",children:(0,a.jsxs)(t.p,{children:["To use clipboard copy, a ",(0,a.jsx)(t.code,{children:"UIPermission"})," of ",(0,a.jsx)(t.code,{children:"UIPermissionClipboard.AllClipboard"})," must be used. Otherwise, no data will be copied, and no exception will be thrown."]})}),"\n",(0,a.jsx)(t.p,{children:"The IncludeColumnHeaders property can be used to control whether the header of each master/detail will be placed included when copying to the clipboard."}),"\n",(0,a.jsxs)(t.p,{children:["The copy command is bound to ",(0,a.jsx)(t.code,{children:"ApplicationCommands.Copy"})," (see Example 1). After the copy command has been executed, the content is available in the clipboard in the formats present in the ",(0,a.jsx)(t.code,{children:"ClipboardExporters"})," property at the time of the copy. Only the formatted data supported by a given application will be available when using Paste Special in the application. For example, after executing the copy command using the default clipboard exporters in ",(0,a.jsx)(t.code,{children:"ClipboardExporters"}),", the content can be pasted into Excel (using ",(0,a.jsx)(t.code,{children:"Paste Special"}),") using the ",(0,a.jsx)(t.strong,{children:"CSV format"}),", among others, while in Word, this format is not available. To prevent a copy from occurring, call the ",(0,a.jsx)(t.code,{children:"Clear"})," method on ",(0,a.jsx)(t.code,{children:"ClipboardExporters"}),"."]}),"\n",(0,a.jsx)(t.p,{children:"Once the datagrid has been initialized, various properties of the clipboard exporters can be modified (see Example 2)."}),"\n",(0,a.jsx)(t.h2,{id:"dragging",children:"Dragging"}),"\n",(0,a.jsx)(t.p,{children:"When the AllowDrag property is set to true, selected rows can simply be dragged to a target host, such as Excel, in order to copy the data directly without performing an explicit copy/paste."}),"\n",(0,a.jsx)(t.h2,{id:"examples",children:"Examples"}),"\n",(0,a.jsx)(t.p,{children:"All examples in this topic assume that the grid is bound to the Orders table of the Northwind database, unless stated otherwise."}),"\n",(0,a.jsxs)(r,{children:[(0,a.jsx)("summary",{children:"Example 1: Copying to the clipboard"}),(0,a.jsx)(t.p,{children:"The following example demonstrates how to copy rows selected in a datagrid control to the clipboard, using XAML."}),(0,a.jsxs)(o.A,{children:[(0,a.jsx)(i.A,{value:"xaml",label:"XAML",default:!0,children:(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-xml",children:'<!\u2014Button bound to the ApplicationCommands.Copy with DataGridControl as CommandTarget --\x3e\r\n<Button Command="ApplicationCommands.Copy"\r\n        CommandTarget="{Binding ElementName=testGrid}"\r\n        Content="Start Test" />\r\n<Grid MaxHeight="800">\r\n  <xcdg:DataGridControl x:Name="testGrid"\r\n                        ItemsSource="{Binding Source={StaticResource cvs_Data}}"\r\n                        ItemScrollingBehavior="Immediate"\r\n                        Height="400" />\r\n</Grid>\n'})})}),(0,a.jsx)(i.A,{value:"csharp",label:"C#",children:(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-csharp",children:"// Where testGrid is the DataGridControl. This sends the RoutedCommand Copy \r\n// to the DataGridControl so that the control can handle it.\r\nApplicationCommands.Copy.Execute( null, this.testGrid ); \n"})})}),(0,a.jsx)(i.A,{value:"vbnet",label:"VB.NET",children:(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-vbnet",children:"' Where testGrid is the DataGridControl. This sends the RoutedCommand Copy \r\n' to the DataGridControl so that the control can handle it.\r\nApplicationCommands.Copy.Execute(Nothing, Me.testGrid)\n"})})})]})]}),"\n",(0,a.jsxs)(r,{children:[(0,a.jsx)("summary",{children:"Example 2: Modifying a clipboard exporter's properties"}),(0,a.jsxs)(t.p,{children:["The following example demonstrates how to modify some of an ",(0,a.jsx)(t.strong,{children:"HtmlClipboardExporter"}),"'s properties."]}),(0,a.jsxs)(o.A,{children:[(0,a.jsx)(i.A,{value:"csharp",label:"C#",default:!0,children:(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-csharp",children:'  HtmlClipboardExporter htmlExporter = this.testGrid.ClipboardExporters[ DataFormats.Html ] as HtmlClipboardExporter;\r\n  htmlExporter.IncludeColumnHeaders = true;\r\n  htmlExporter.FormatSettings.DateTimeFormat = "f";\r\n  htmlExporter.FormatSettings.NumericFormat = "0.0000";\n'})})}),(0,a.jsx)(i.A,{value:"vbnet",label:"VB.NET",children:(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-vbnet",children:'  Dim htmlExporter As HtmlClipboardExporter = TryCast(Me.testGrid.ClipboardExporters(DataFormats.Html), HtmlClipboardExporter) \r\n  htmlExporter.IncludeColumnHeaders = True\r\n  htmlExporter.FormatSettings.DateTimeFormat = "f"\r\n  htmlExporter.FormatSettings.NumericFormat = "0.0000"\n'})})})]})]})]})}function h(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}},9365:(e,t,r)=>{r.d(t,{A:()=>i});r(6540);var a=r(4164);const n={tabItem:"tabItem_Ymn6"};var o=r(4848);function i(e){let{children:t,hidden:r,className:i}=e;return(0,o.jsx)("div",{role:"tabpanel",className:(0,a.A)(n.tabItem,i),hidden:r,children:t})}},1470:(e,t,r)=>{r.d(t,{A:()=>y});var a=r(6540),n=r(4164),o=r(3104),i=r(6347),s=r(205),l=r(7485),d=r(1682),c=r(679);function u(e){return a.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:t,children:r}=e;return(0,a.useMemo)((()=>{const e=t??function(e){return u(e).map((e=>{let{props:{value:t,label:r,attributes:a,default:n}}=e;return{value:t,label:r,attributes:a,default:n}}))}(r);return function(e){const t=(0,d.XI)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,r])}function h(e){let{value:t,tabValues:r}=e;return r.some((e=>e.value===t))}function m(e){let{queryString:t=!1,groupId:r}=e;const n=(0,i.W6)(),o=function(e){let{queryString:t=!1,groupId:r}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return r??null}({queryString:t,groupId:r});return[(0,l.aZ)(o),(0,a.useCallback)((e=>{if(!o)return;const t=new URLSearchParams(n.location.search);t.set(o,e),n.replace({...n.location,search:t.toString()})}),[o,n])]}function b(e){const{defaultValue:t,queryString:r=!1,groupId:n}=e,o=p(e),[i,l]=(0,a.useState)((()=>function(e){let{defaultValue:t,tabValues:r}=e;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!h({value:t,tabValues:r}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${r.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=r.find((e=>e.default))??r[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:o}))),[d,u]=m({queryString:r,groupId:n}),[b,x]=function(e){let{groupId:t}=e;const r=function(e){return e?`docusaurus.tab.${e}`:null}(t),[n,o]=(0,c.Dv)(r);return[n,(0,a.useCallback)((e=>{r&&o.set(e)}),[r,o])]}({groupId:n}),f=(()=>{const e=d??b;return h({value:e,tabValues:o})?e:null})();(0,s.A)((()=>{f&&l(f)}),[f]);return{selectedValue:i,selectValue:(0,a.useCallback)((e=>{if(!h({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);l(e),u(e),x(e)}),[u,x,o]),tabValues:o}}var x=r(2303);const f={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var g=r(4848);function v(e){let{className:t,block:r,selectedValue:a,selectValue:i,tabValues:s}=e;const l=[],{blockElementScrollPositionUntilNextRender:d}=(0,o.a_)(),c=e=>{const t=e.currentTarget,r=l.indexOf(t),n=s[r].value;n!==a&&(d(t),i(n))},u=e=>{let t=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const r=l.indexOf(e.currentTarget)+1;t=l[r]??l[0];break}case"ArrowLeft":{const r=l.indexOf(e.currentTarget)-1;t=l[r]??l[l.length-1];break}}t?.focus()};return(0,g.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,n.A)("tabs",{"tabs--block":r},t),children:s.map((e=>{let{value:t,label:r,attributes:o}=e;return(0,g.jsx)("li",{role:"tab",tabIndex:a===t?0:-1,"aria-selected":a===t,ref:e=>l.push(e),onKeyDown:u,onClick:c,...o,className:(0,n.A)("tabs__item",f.tabItem,o?.className,{"tabs__item--active":a===t}),children:r??t},t)}))})}function j(e){let{lazy:t,children:r,selectedValue:o}=e;const i=(Array.isArray(r)?r:[r]).filter(Boolean);if(t){const e=i.find((e=>e.props.value===o));return e?(0,a.cloneElement)(e,{className:(0,n.A)("margin-top--md",e.props.className)}):null}return(0,g.jsx)("div",{className:"margin-top--md",children:i.map(((e,t)=>(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==o})))})}function C(e){const t=b(e);return(0,g.jsxs)("div",{className:(0,n.A)("tabs-container",f.tabList),children:[(0,g.jsx)(v,{...t,...e}),(0,g.jsx)(j,{...t,...e})]})}function y(e){const t=(0,x.A)();return(0,g.jsx)(C,{...e,children:u(e.children)},String(t))}},8453:(e,t,r)=>{r.d(t,{R:()=>i,x:()=>s});var a=r(6540);const n={},o=a.createContext(n);function i(e){const t=a.useContext(o);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),a.createElement(o.Provider,{value:t},e.children)}}}]);